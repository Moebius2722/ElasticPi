vrrp_instance VI_SYSLOG {
  state MASTER
  interface eth0
  virtual_router_id 31
  priority 150
  advert_int 1
  authentication {
    auth_type AH
    auth_pass k@l!ve2
  }
  virtual_ipaddress {
        192.168.0.10/24
  }
  notify_master "/etc/keepalived/bypass_ipvs.sh del 192.168.0.10"
  notify_backup "/etc/keepalived/bypass_ipvs.sh add 192.168.0.10"
  notify_fault "/etc/keepalived/bypass_ipvs.sh add 192.168.0.10"
}
vrrp_instance VI_KIBANA {
  state BACKUP
  interface eth0
  virtual_router_id 32
  priority 120
  advert_int 1
  authentication {
    auth_type AH
    auth_pass k@l!ve3
  }
  virtual_ipaddress {
        192.168.0.11/24
  }
  notify_master "/etc/keepalived/bypass_ipvs.sh del 192.168.0.11"
  notify_backup "/etc/keepalived/bypass_ipvs.sh add 192.168.0.11"
  notify_fault "/etc/keepalived/bypass_ipvs.sh add 192.168.0.11"
}
vrrp_instance VI_SQUID {
  state BACKUP
  interface eth0
  virtual_router_id 33
  priority 130
  advert_int 1
  authentication {
    auth_type AH
    auth_pass k@l!ve2
  }
  virtual_ipaddress {
        192.168.0.12/24
  }
  notify_master "/etc/keepalived/bypass_ipvs.sh del 192.168.0.12"
  notify_backup "/etc/keepalived/bypass_ipvs.sh add 192.168.0.12"
  notify_fault "/etc/keepalived/bypass_ipvs.sh add 192.168.0.12"
}
vrrp_instance VI_CEREBRO {
  state BACKUP
  interface eth0
  virtual_router_id 34
  priority 140
  advert_int 1
  authentication {
    auth_type AH
    auth_pass k@l!ve2
  }
  virtual_ipaddress {
        192.168.0.13/24
  }
  notify_master "/etc/keepalived/bypass_ipvs.sh del 192.168.0.13"
  notify_backup "/etc/keepalived/bypass_ipvs.sh add 192.168.0.13"
  notify_fault "/etc/keepalived/bypass_ipvs.sh add 192.168.0.13"
}
vrrp_instance VI_NODERED {
  state MASTER
  interface eth0
  virtual_router_id 35
  priority 150
  authentication {
    auth_type AH
    auth_pass k@l!ve2
  }
  virtual_ipaddress {
        192.168.0.14/24
  }
  notify_master "/etc/keepalived/bypass_ipvs.sh del 192.168.0.14"
  notify_backup "/etc/keepalived/bypass_ipvs.sh add 192.168.0.14"
  notify_fault "/etc/keepalived/bypass_ipvs.sh add 192.168.0.14"
}
vrrp_instance VI_MOSQUITTO {
  state MASTER
  interface eth0
  virtual_router_id 35
  priority 150
  authentication {
    auth_type AH
    auth_pass k@l!ve2
  }
  virtual_ipaddress {
        192.168.0.15/24
  }
  notify_master "/etc/keepalived/bypass_ipvs.sh del 192.168.0.15"
  notify_backup "/etc/keepalived/bypass_ipvs.sh add 192.168.0.15"
  notify_fault "/etc/keepalived/bypass_ipvs.sh add 192.168.0.15"
}
virtual_server 192.168.0.10 5000 {
  delay_loop 15
  lb_algo rr
  lb_kind DR
  persistence_timeout 50
  protocol TCP

  real_server 192.168.0.21 5000 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.22 5000 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.23 5000 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.24 5000 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
}
virtual_server 192.168.0.11 80 {
  delay_loop 15
  lb_algo rr
  lb_kind DR
  persistence_timeout 50
  protocol TCP

  real_server 192.168.0.21 80 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.22 80 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.23 80 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.24 80 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
}
virtual_server 192.168.0.12 5001 {
  delay_loop 15
  lb_algo rr
  lb_kind DR
  persistence_timeout 50
  protocol TCP

  real_server 192.168.0.21 5001 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.22 5001 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.23 5001 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.24 5001 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
}
virtual_server 192.168.0.13 9000 {
  delay_loop 15
  lb_algo rr
  lb_kind DR
  persistence_timeout 50
  protocol TCP

  real_server 192.168.0.21 9000 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.22 9000 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.23 9000 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.24 9000 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
}
virtual_server 192.168.0.14 1880 {
  delay_loop 15
  lb_algo rr
  lb_kind DR
  persistence_timeout 50
  protocol TCP

  real_server 192.168.0.21 1880 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.22 1880 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.23 1880 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.24 1880 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
}
virtual_server 192.168.0.15 1883 {
  delay_loop 15
  lb_algo rr
  lb_kind DR
  persistence_timeout 50
  protocol TCP

  real_server 192.168.0.21 1883 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.22 1883 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.23 1883 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
  real_server 192.168.0.24 1883 {
    TCP_CHECK {
      connect_timeout 3
    }
  }
}

